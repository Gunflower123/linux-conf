#!/bin/bash
#
# Script name: autowifi
# Description: Automatically connects to wifi using wpa_supplicant
# Dependencies: net-tools, base-devel, wpa_supplicant, dhcpcd

DIR=/etc/wpa_supplicant/wpa_su
# Kill wifi process if running
killall wpa_supplicant
# Check driver status
[ lspci -k | grep -q 'iwlwifi' ] && notify-send "Message: iwlwifi Kernel-driver present"

# Determine WiFi interface
if iw dev | grep -q 'wlan0' -a ifcongif -a | grep -Eq 'wlan0|DOWN'; then
  ip link set wlan0 up    #Set WiFi interface <UP>
  notify-send "Message: WiFi interface active"
  #[-l "$1" "$2" ] && iw dev "$1" connect "$2" 
fi

# Show connection using 
[ -l "$1" ] && iw dev "$1" link || notify-send "Message: Not Connected."
# Connect using wpa_supplicant
[ iw dev "$1" link -eq "Not Connected." ] && wpa_supplicant -B -c "$DIR" -i "$1" && notify-send "Successful WiFi-Protected Access Connection."
# Use Dynamic Host Configuration Protocol (DHCP) connection
dhcpcd "$1" && notify-send "Successul Dynamic Host Configuration Protocol Connection."
